<%@ page import="reger.logProps"%>
<%
/*----------------------------------------------------*/
/*                  Page Config                       */
reger.pageFramework.PageProps pageProps = new reger.pageFramework.PageProps();
pageProps.siteSection=pageProps.PUBLICSITE;
pageProps.isPasswordProtected = false;
pageProps.isLogidRequired=true;
pageProps.isEventidRequired=true;
pageProps.trafficType=reger.Vars.TRAFFICTYPEPUBLICENTRYDETAIL;
pageProps.pathToAppRoot="";
/*----------------------------------------------------*/
%>

<%@ include file="globalheader.jsp" %>

<%
/*----------------------------------------------------*/
/*                  Main Body                         */
        StringBuffer mb = new StringBuffer();
/*----------------------------------------------------*/

//Instantiate the entry object
//pageProps.entry.populate(userSession.getAccountuser(), userSession.getAccount(), userSession.getPl(), pageProps.logProps.logid, request);

int tmpEventid = 0;
if (request.getParameter("eventid")!=null && reger.core.Util.isinteger(request.getParameter("eventid"))) {
    tmpEventid=Integer.parseInt(request.getParameter("eventid"));
}
pageProps.entry = reger.cache.EntryCache.get(tmpEventid);

//Any log entry viewed from this public entry.log should use userSession.getAccount().getTimezoneid()
pageProps.entry.entryTimezoneid=userSession.getAccount().getTimezoneid();
//pageProps.entry.getEntryAll();

//Hide draft and unapproved entries
if (pageProps.entry.isDraft==1 || pageProps.entry.isApproved==0){
    response.sendRedirect("index.log");
    return;
}

//Start the page
//Determine which mode to display the page
boolean displayasadmin=false;

//Append the top of the form
mb.append(reger.MegaHtmlFormTop.getHtml(userSession, pageProps, displayasadmin, request));
//Append the center of the page
mb.append(reger.MegaHtmlFormCenter.getHtml(userSession, pageProps, displayasadmin, request));
//Append the bottom of the form
mb.append(reger.MegaHtmlFormBottom.getHtml(userSession, pageProps, displayasadmin, request, response));

%>

<%
/*----------------------------------------------------*/
/*                  Side Column                       */
        StringBuffer sc = new StringBuffer();
/*----------------------------------------------------*/


//Charts and Graphs
sc.append(reger.SideColumn.chartsngraphs(pageProps.logProps.logid, userSession));

//Favorite entries
sc.append(reger.SideColumn.favorites(pageProps.logProps.logid, pageProps.logProps.megalogname));

//Messages for this log
sc.append(reger.SideColumn.messages(pageProps.logProps.logid, pageProps.logProps.megalogname));

//Xml link
sc.append("<br><!-- XML Start --><a href='rssfeeds.log'><img src='images/xml-newsfeed.png' alt='View this site in XML RSS' border=0></a><!-- XML End -->");


%>

<%@ include file="globalfooter.jsp" %>

