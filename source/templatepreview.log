<%@ page import="reger.template.Template,
                 reger.template.TemplateProcessor"%>
<%
/*----------------------------------------------------*/
/*                  Page Config                       */
reger.pageFramework.PageProps pageProps = new reger.pageFramework.PageProps();
pageProps.siteSection=pageProps.MARKETINGSITE;
pageProps.isPasswordProtected = false;
pageProps.pathToAppRoot="";
/*----------------------------------------------------*/
%>

<%@ include file="globalheader.jsp" %>

<%
/*----------------------------------------------------*/
/*                  Main Body                         */
        StringBuffer mb = new StringBuffer();
/*----------------------------------------------------*/

reger.core.Util.debug(5, "templatepreview.log - templateid=" + request.getParameter("templateid"));

//Get type
int type = -1;
if (request.getParameter("type")!=null && reger.core.Util.isinteger(request.getParameter("type"))){
    type = Integer.parseInt(request.getParameter("type"));
}

//Set the pageProps var to force a template preview
if (request.getParameter("templateid")!=null && reger.core.Util.isinteger(request.getParameter("templateid"))) {
    int templateid=Integer.parseInt(request.getParameter("templateid"));

    //Get the template
    Template template = reger.template.AllTemplatesInSystem.getTemplateByTemplateid(templateid, type);

    //Get the processor
    TemplateProcessor tmp = reger.template.TemplateProcessorFactory.getProcessorByType(template.getType());

    //Get the preview
    mb.append(tmp.preview(template));

}

out.print(mb.toString());




%>

<%
/*----------------------------------------------------*/
/*                  Side Column                       */
        StringBuffer sc = new StringBuffer();
/*----------------------------------------------------*/

//sc.append("This is a ");
//sc.append("side column section.");

//sc.append(reger.CalendarHtml.smallcalendar(reger.Vars.CALENDARTYPEEMPTYEVENTFINDER, request.getParameter("viewmonth"), pageProps.logProps.logid, "index.log", userSession));

%>

<% //@ include file="globalfooter.jsp" %>

