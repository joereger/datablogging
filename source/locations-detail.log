<%@ page import="reger.LocationRenderHtml,
                 reger.Location"%>
<%
/*----------------------------------------------------*/
/*                  Page Config                       */
reger.pageFramework.PageProps pageProps = new reger.pageFramework.PageProps();
pageProps.siteSection=pageProps.PUBLICSITE;
pageProps.isPasswordProtected = false;
pageProps.isLogidRequired=false;
pageProps.isEventidRequired=false;
pageProps.trafficType=reger.Vars.TRAFFICTYPEPUBLICMISC;
pageProps.pathToAppRoot="";
/*----------------------------------------------------*/
%>

<%@ include file="globalheader.jsp" %>

<%
/*----------------------------------------------------*/
/*                  Main Body                         */
        StringBuffer mb = new StringBuffer();
/*----------------------------------------------------*/

//@todo Locations.log not working

//Parse the incoming locationid
int locationid=0;
Location loc = null;
if (request.getParameter("locationid")!=null && !request.getParameter("locationid").equals("") && reger.core.Util.isinteger(request.getParameter("locationid"))){
    locationid=Integer.parseInt(request.getParameter("locationid"));
    //@todo Make sure user can view this location
    loc = new Location(locationid);
}
if (loc==null || locationid==0){
    response.sendRedirect("locations.log");
    return;
}



mb.append("<font face=arial size=+1 class=largefont>");
mb.append("Entries From: "+loc.getLocationname());
mb.append("</font>");

mb.append("<br>");
mb.append("<font face=arial size=-2>");
mb.append("<a href='locations.log'>");
mb.append("View All Locations");
mb.append("</a>");
if (loc.hasGpsCoordinates()){
    mb.append(" | ");
    mb.append("<a href='locations.log?locationid="+loc.getLocationid()+"'>");
    mb.append("View on a Map");
    mb.append("</a>");
}

mb.append("</font>");



//mb.append("<table cellpadding=0 cellspacing=10 width=100% border=0>");
//mb.append("<tr>");
//mb.append("<td valign=top align=left>");
//if (locationid>0){
//    mb.append("<font face=arial size=-2>");
//    mb.append(LocationRenderHtml.getSingleLocationAsHtml(loc, false, ""));
//    mb.append("</font>");
//}
//mb.append("</td>");
//mb.append("</tr>");
//mb.append("</table>");



//Now display the entries befitting of our named locationid
if (locationid>0){
    mb.append("<br>");
    mb.append("<br>");
    mb.append(reger.htmlListEvents.getList(userSession, 0, reger.core.Util.getCurrentPage(request.getParameter("currentpage")), request.getParameter("viewdate"), request.getParameter("viewmonth"), "locations.log", locationid, true, request));
}


%>

<%
/*----------------------------------------------------*/
/*                  Side Column                       */
        StringBuffer sc = new StringBuffer();
/*----------------------------------------------------*/

//sc.append(reger.SideColumn.favorites(pageProps.logProps.logid, pageProps.logProps.megalogname));

%>

<%@ include file="globalfooter.jsp" %>

