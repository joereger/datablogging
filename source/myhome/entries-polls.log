<%@ page import="reger.poll.PollUtil"%>
<%@ page import="java.util.ArrayList"%>
<%@ page import="java.util.Iterator"%>
<%@ page import="java.util.StringTokenizer"%>
<%
/*----------------------------------------------------*/
/*                  Page Config                       */
    reger.pageFramework.PageProps pageProps = new reger.pageFramework.PageProps();
    pageProps.siteSection=pageProps.ADMINSITE;
    pageProps.title = "Polls";
    pageProps.isPasswordProtected = true;
    pageProps.navButtonName = "entriespolls";
    pageProps.aclObjectName = "ADDEDITENTRIES";
    pageProps.trafficType=reger.Vars.TRAFFICTYPEADMINMISC;
    pageProps.pathToAppRoot="../";
/*----------------------------------------------------*/
%>

<%@ include file="../globalheader.jsp" %>

<%
/*----------------------------------------------------*/
/*                  Main Body                         */
        StringBuffer mb = new StringBuffer();
/*----------------------------------------------------*/
    PollUtil pollUtil = new PollUtil();
    ArrayList dataList = pollUtil.getPollData(userSession);
    StringTokenizer stkr = null;
    mb.append(reger.ui.BubbleBox.start("", pageProps.pathToAppRoot));
    mb.append("<table>");
    if (dataList != null && dataList.size() > 0) {
        Iterator iter = dataList.iterator();
        while (iter.hasNext()) {
            String value = (String) iter.next();
            stkr = new StringTokenizer(value, "~");
            while (stkr.hasMoreElements()) {
                String eventid = (String) stkr.nextElement();
                String title = (String) stkr.nextElement();
                String pollid = (String) stkr.nextElement();
                String question = (String) stkr.nextElement();
                String isOpen = (String) stkr.nextElement();
                mb.append("<tr><td>");
                mb.append( "<a href=entries-poll-settings.log?pollid="+pollid+">"+question+"</a>");
                mb.append("</td><td>");
                if (isOpen.equalsIgnoreCase("1")) {
                    mb.append("Open");
                } else {
                    mb.append("Closed");
                }
                mb.append("</td><tr><td> Total Votes : ");
                mb.append( (String) stkr.nextElement());
                mb.append("</td></tr><tr><td>Total Comments : ");
                mb.append( (String) stkr.nextElement());
                mb.append("</td></tr><tr><td>Unapproved Answers / Comments : ");
                mb.append( (String) stkr.nextElement());
                mb.append("</td></tr><tr><td>From Entry : ");
                mb.append("<a href=../entry.log?eventid=" + eventid + ">"+title+"</a>");
                mb.append("</td></tr>");
            }
        }
    }
    mb.append("</table>");
    mb.append(reger.ui.BubbleBox.end(pageProps.pathToAppRoot));
%>

<%
/*----------------------------------------------------*/
/*                  Side Column                       */
    StringBuffer sc = new StringBuffer();
/*----------------------------------------------------*/
%>

<%@ include file="../globalfooter.jsp" %>