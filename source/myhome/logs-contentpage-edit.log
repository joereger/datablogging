<%@ page import="reger.core.db.Db,
                 reger.core.Util,
                 reger.nestednav.NestedNavItem,
                 reger.nestednav.NestedNavCollection,
                 reger.ContentPage"%>
<%
/*----------------------------------------------------*/
/*                  Page Config                       */
reger.pageFramework.PageProps pageProps = new reger.pageFramework.PageProps();
pageProps.siteSection=pageProps.ADMINSITE;
pageProps.title = "<img src='../images/icon-static-page-med-notext.gif' align=top> Static Content Page";
pageProps.isPasswordProtected = true;
pageProps.navButtonName = "logsnewstatic";
pageProps.aclObjectName = "CUSTOMIZELOG";
pageProps.trafficType=reger.Vars.TRAFFICTYPEADMINMISC;
pageProps.pathToAppRoot="../";
//pageProps.isLogidRequired=true;
/*----------------------------------------------------*/
%>

<%@ include file="../globalheader.jsp" %>

<%
/*----------------------------------------------------*/
/*                  Main Body                         */
    StringBuffer mb = new StringBuffer();
/*----------------------------------------------------*/


ContentPage contentPage = new ContentPage();
if (request.getParameter("contentpageid")!=null && reger.core.Util.isinteger(request.getParameter("contentpageid"))){
    contentPage = new ContentPage(Integer.parseInt(request.getParameter("contentpageid")));
}


if (pageProps.action.equals("save")){
    //Name
    if (request.getParameter("name")!=null && !request.getParameter("name").equals("")){
        contentPage.setName(request.getParameter("name"));
    } else {
        contentPage.setName("");
    }

    //Content
    if (request.getParameter("content")!=null && !request.getParameter("content").equals("")){
        contentPage.setContent(request.getParameter("content"));
    } else {
        contentPage.setContent("");
    }

    //Accountid
    contentPage.setAccountid(userSession.getAccount().getAccountid());

    //Do the save
    contentPage.save();

    //Account refresh
    userSession.getAccount().refresh();

    //Success
    //mb.append(reger.InfoBox.get(reger.InfoBox.BOXTYPECOMPLETE, pageProps.pathToAppRoot, "The static content page has been saved."));
    response.sendRedirect("logs-log-list.log");
    return;
}

//Log Header start
String currentNavButtonName = "";
%>
<%@ include file="logs-header.jsp" %>
<%
//Log Header end

mb.append("");

mb.append(reger.InfoBox.get(reger.InfoBox.BOXTYPEINFO, pageProps.pathToAppRoot, "Static content pages are not blog entries!  Please read and understand what they are before using them.  They're not dangerous, but they may not be what you think they are."));



mb.append("<form action=logs-contentpage-edit.log method=post>");
mb.append("<input type=hidden name=action value=save>");
mb.append("<input type=hidden name=contentpageid value="+contentPage.getContentpageid()+">");

mb.append("<table cellpadding=10 cellspacing=0 width=100% border=0>");

mb.append("<tr>");
mb.append("<td valign=top>");
mb.append("<font face=arial size=-1><b>");
mb.append("Content Page Name:");
mb.append("</b></font>");
mb.append("<br>");
mb.append("<input type=text name=name size=25 maxlength='50' value=\""+reger.core.Util.cleanForHtml(contentPage.getName())+"\"");
mb.append("<input type=submit value='Save the Page'>");
mb.append("<br><br>");
mb.append("<font face=arial size=-1><b>");
mb.append("Page Content:");
mb.append("</b></font>");
mb.append("<br>");
mb.append("<textarea name=content cols=45 rows=75 style=\"width: 100%;\">"+contentPage.getContent()+"</textarea>");
mb.append("</td>");




mb.append("<td valign=top width=30% >");
mb.append("<div class=greybox>");
mb.append("<font face=arial size=-1>");
mb.append("<b>Static content pages are not log entries and they're not log!</b>  They're more like standard web pages.  They don't play a role in RSS, calendars, searching or anythign else that's considered 'bloggy.'");
mb.append("<br><br>");
mb.append("<b>Why use a static content page?</b> As you build your weblog, you'll invariably want to link to some content that doesn't change much and that has a button somewhere in the main navigation scheme.  A good example is a contact information page.  Using the static content pages you could, if you wanted to, build an entire site with a very complex nested architecture... but you'll be missing out on a lot of the power of blogging.");
mb.append("<br><br>");
mb.append("<b>What else are they good for?</b> One of their primary uses has to do with grouping of logs.  You must group logs under either another log or a static content page.  Sometimes the grouping is best done under a static content page.  To do this, create a new static content page and then move logs or other static content pages underneath it.  A good example is physical fitness logs... have one static content page that describes all of the logs and then put all of them underneath that static content page.  Play with it... it's flexible.");
mb.append("<br><br>");
mb.append("<b>You can use html.</b>  Whatever you type into the box will be put out the screen..");
mb.append("<br><br>");
mb.append("<b>Note that currently all content pages are automatically public</b> and anybody will be able to view them.");
mb.append("</font>");
mb.append("</div>");
mb.append("</td>");
mb.append("</tr>");

mb.append("</table>");
mb.append("</form>");


mb.append("<br><br><br><br><br>");



//Log Footer start
%>
<%@ include file="logs-footer.jsp" %>
<%
//Log Footer end




%>

<%
/*----------------------------------------------------*/
/*                  Side Column                       */
    StringBuffer sc = new StringBuffer();
/*----------------------------------------------------*/
//sc.append("This is a ");
//sc.append("side column section.");

%>


<%@ include file="../globalfooter.jsp" %>
