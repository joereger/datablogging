<%@ page import="reger.core.db.Db,
                 org.apache.xmlrpc.XmlRpcClient,
                 java.util.Vector,
                 java.util.Hashtable,
                 reger.core.db.Db"%>
<%@ page import="reger.groups.GroupMembership"%>
<%@ page import="reger.groups.Group"%>
<%@ page import="reger.core.ValidationException"%>
<%
/*----------------------------------------------------*/
/*                  Page Config                       */
reger.pageFramework.PageProps pageProps = new reger.pageFramework.PageProps();
pageProps.siteSection=pageProps.ADMINSITE;
pageProps.title = "Group";
pageProps.isPasswordProtected = true;
pageProps.navButtonName = "groups";
pageProps.aclObjectName = "MANAGEGROUPS";
pageProps.trafficType=reger.Vars.TRAFFICTYPEADMINMISC;
pageProps.pathToAppRoot="../";
/*----------------------------------------------------*/
%>

<%@ include file="../globalheader.jsp" %>

<%

/*----------------------------------------------------*/
/*                  Main Body                         */
        StringBuffer mb = new StringBuffer();
/*----------------------------------------------------*/


GroupMembership groupMembership = null;
if(request.getParameter("groupmembershipid")!=null && reger.core.Util.isinteger(request.getParameter("groupmembershipid"))){
    groupMembership = new GroupMembership(Integer.parseInt(request.getParameter("groupmembershipid")));
}

if (groupMembership==null || groupMembership.getAccountuserid()!=userSession.getAccountuser().getAccountuserid()){
    response.sendRedirect("groups.log");
    return;
}

Group group = new Group(groupMembership.getGroupid());

if (pageProps.action.equals("editmembership")){
    if (request.getParameter("sharemembershippublicly")!=null && request.getParameter("sharemembershippublicly").equals("1")){
        groupMembership.setSharemembershippublicly(true);
    } else {
        groupMembership.setSharemembershippublicly(false);
    }
    try{
        groupMembership.save();
        mb.append(reger.InfoBox.get(reger.InfoBox.BOXTYPECOMPLETE, pageProps.pathToAppRoot, "Saved!"));
    } catch (ValidationException vex){
        mb.append(reger.InfoBox.get(reger.InfoBox.BOXTYPEERROR, pageProps.pathToAppRoot, vex.getErrorsAsSingleString()));
    }
}


mb.append(reger.ui.BubbleBox.start("", pageProps.pathToAppRoot));



mb.append("<table cellpadding=5 cellspacing=2 width=100% border=0>");

mb.append("<form action=groups-editmembership.log method=post>");
mb.append("<input type=hidden name=groupmembershipid value='"+groupMembership.getGroupmembershipid()+"'>");
mb.append("<input type=hidden name=action value='editmembership'>");

mb.append("<tr>");
mb.append("<td valign=top bgcolor=#e6e6e6 align=right>");
mb.append("<font face=arial size=-1>");
mb.append("<b>");
mb.append("Group Name");
mb.append("</b>");
mb.append("</font>");
mb.append("<br>");
mb.append("<font face=arial size=-2>");
mb.append("</font>");
mb.append("</td>");
mb.append("<td valign=top>");
mb.append("<font face=arial size=+1>");
mb.append("<b>");
mb.append(group.getName());
mb.append("</b>");
mb.append("</font>");
mb.append("</td>");
mb.append("</tr>");

mb.append("<tr>");
mb.append("<td valign=top bgcolor=#e6e6e6 align=right>");
mb.append("<font face=arial size=-1>");
mb.append("<b>");
mb.append("Group Description");
mb.append("</b>");
mb.append("</font>");
mb.append("<br>");
mb.append("<font face=arial size=-2>");
mb.append("</font>");
mb.append("</td>");
mb.append("<td valign=top>");
mb.append("<font face=arial size=-2>");
mb.append(group.getDescription());
mb.append("</font>");
mb.append("</td>");
mb.append("</tr>");





mb.append("<tr>");
mb.append("<td valign=top bgcolor=#e6e6e6 align=right>");
mb.append("<font face=arial size=-1>");
mb.append("<b>Share Membership Publicly</b>");
mb.append("</font>");
mb.append("<br>");
mb.append("<font face=arial size=-2>");
mb.append("Whether or not you want this group membership to be listed on your public profile.  Members of the group will be able to see your membership regardless of this setting.");
mb.append("</font>");
mb.append("</td>");
mb.append("<td valign=top>");
mb.append("<font face=arial size=-2>");
String spYes = "";
if (groupMembership.getSharemembershippublicly()){
    spYes = "checked";
}
mb.append("<input type=radio name=sharemembershippublicly value='1' "+spYes+">");
mb.append("<img src='../images/icon-public.gif' width='16' height='16' alt='' border='0'>");
mb.append(" Yes, share my membership in this group publicly");
mb.append("<br>");
String spNo = "";
if (!groupMembership.getSharemembershippublicly()){
    spNo = "checked";
}
mb.append("<input type=radio name=sharemembershippublicly value='0' "+spNo+">");
mb.append("<img src='../images/icon-private.gif' width='16' height='16' alt='' border='0'>");
mb.append(" No, keep my membership in this group visible only to members of the group");
mb.append("</font>");
mb.append("</td>");
mb.append("</tr>");




mb.append("<tr>");
mb.append("<td valign=top bgcolor=#e6e6e6 align=right>");
mb.append("<font face=arial size=-1>");
mb.append("<b>");
mb.append("");
mb.append("</b>");
mb.append("</font>");
mb.append("<br>");
mb.append("<font face=arial size=-2>");
mb.append("</font>");
mb.append("</td>");
mb.append("<td valign=top>");
mb.append("<font face=arial size=-2>");
mb.append("<input type=submit value='Save Membership'>");
mb.append("</font>");
mb.append("</td>");
mb.append("</tr>");

mb.append("</form>");

mb.append("</table>");
mb.append(reger.ui.BubbleBox.end(pageProps.pathToAppRoot));

mb.append("<br>");
mb.append("<font face=arial size=-2>");
mb.append("<a href='groups-leavegroup.log?groupmembershipid="+groupMembership.getGroupmembershipid()+"&action=leave'>");
mb.append("Delete Membership");
mb.append("</a>");
mb.append("</font>");



%>

<%
/*----------------------------------------------------*/
/*                  Side Column                       */
    StringBuffer sc = new StringBuffer();
/*----------------------------------------------------*/

//sc.append("This is a ");
//sc.append("side column section.");
%>


<%@ include file="../globalfooter.jsp" %>
